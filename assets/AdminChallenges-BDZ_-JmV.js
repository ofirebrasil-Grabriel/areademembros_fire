import{g,j as e,B as m,s as j}from"./index-CJHEqyXL.js";import{r,u as N}from"./vendor-gtDS_TVX.js";import{a as h,a5 as b,v,a6 as y,a7 as w,a8 as D,T as z}from"./ui-R5Y-RMdR.js";import"./supabase-CBvtPKqy.js";const S=()=>{const[i,l]=r.useState([]),[f,n]=r.useState(!0),[c,d]=r.useState(null),o=N();r.useEffect(()=>{x()},[]);const x=async()=>{n(!0);const s=await g();l(s),n(!1)},p=async s=>{if(window.confirm("Tem certeza que deseja excluir este dia? Esta ação não pode ser desfeita.")){d(s);try{const{error:t}=await j.from("challenges").delete().eq("id",s);t&&console.warn("Could not delete from DB (might be mock data), removing from UI only."),l(a=>a.filter(u=>u.id!==s))}catch(t){console.error("Error deleting day:",t)}finally{d(null)}}};return f?e.jsxs("div",{className:"flex items-center justify-center h-64 text-fire-gray",children:[e.jsx(h,{className:"animate-spin mr-2"})," Carregando desafios..."]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white font-montserrat",children:"Gerenciar Desafios"}),e.jsx("p",{className:"text-fire-gray text-sm mt-1",children:"Organize os 15 dias de conteúdo, tarefas e materiais."})]}),e.jsxs(m,{onClick:()=>o("/admin/challenges/new"),className:"flex items-center gap-2",children:[e.jsx(b,{size:18})," Novo Dia"]})]}),e.jsx("div",{className:"bg-fire-secondary/20 border border-white/5 rounded-xl overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-black/20 text-fire-gray text-xs uppercase tracking-wider border-b border-white/5",children:[e.jsx("th",{className:"p-4 font-medium",children:"Dia"}),e.jsx("th",{className:"p-4 font-medium",children:"Título & Descrição"}),e.jsx("th",{className:"p-4 font-medium text-center",children:"Tarefas"}),e.jsx("th",{className:"p-4 font-medium text-center",children:"Materiais"}),e.jsx("th",{className:"p-4 font-medium text-right",children:"Ações"})]})}),e.jsxs("tbody",{className:"divide-y divide-white/5",children:[i.map(s=>{var t,a;return e.jsxs("tr",{className:"hover:bg-white/5 transition-colors group",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex flex-col items-center justify-center w-12 h-12 rounded-lg bg-fire-secondary/40 border border-white/10 font-bold text-white",children:[e.jsx("span",{className:"text-xs text-fire-orange uppercase",children:"DIA"}),e.jsx("span",{className:"text-lg",children:s.day_number})]})}),e.jsxs("td",{className:"p-4 max-w-md",children:[e.jsx("div",{className:"font-bold text-white mb-1 font-montserrat line-clamp-1",children:s.title.replace(/^Dia \d+: /,"")}),e.jsx("div",{className:"text-xs text-fire-gray line-clamp-2",children:s.description})]}),e.jsx("td",{className:"p-4 text-center",children:e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-blue-500/10 text-blue-400 border border-blue-500/20 text-xs font-medium",children:[e.jsx(v,{size:14}),((t=s.tasks)==null?void 0:t.length)||0]})}),e.jsx("td",{className:"p-4 text-center",children:e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-purple-500/10 text-purple-400 border border-purple-500/20 text-xs font-medium",children:[e.jsx(y,{size:14}),((a=s.resources)==null?void 0:a.length)||0]})}),e.jsx("td",{className:"p-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>o(`/admin/challenges/edit/${s.day_number}`),className:"p-2 rounded-lg text-fire-gray hover:text-white hover:bg-white/10 transition-colors",title:"Editar",children:e.jsx(w,{size:18})}),e.jsx("button",{onClick:()=>p(s.id),disabled:c===s.id,className:"p-2 rounded-lg text-fire-gray hover:text-red-400 hover:bg-red-500/10 transition-colors disabled:opacity-50",title:"Excluir",children:c===s.id?e.jsx(h,{size:18,className:"animate-spin"}):e.jsx(D,{size:18})})]})})]},s.id)}),i.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-8 text-center text-fire-gray",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(z,{size:32,className:"opacity-50"}),e.jsx("p",{children:"Nenhum desafio encontrado."}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>x(),className:"mt-2",children:"Recarregar"})]})})})]})]})})})]})};export{S as AdminChallenges};
