import{C as v,j as e,D as w}from"./index-BWNE2clS.js";import{r as i}from"./vendor-gtDS_TVX.js";import{a as x,ai as y,aj as z,a8 as k,F as C,ak as F,w as h}from"./ui-R5Y-RMdR.js";import"./supabase-B6PhnEZn.js";const T=()=>{const[n,l]=i.useState([]),[u,o]=i.useState(!0),[c,d]=i.useState(null),[p,m]=i.useState(null);i.useEffect(()=>{j()},[]);const j=async()=>{o(!0);const t=await v();l(t),o(!1)},g=async t=>{if(window.confirm(`Tem certeza que deseja excluir permanentemente o arquivo "${t}"?`)){d(t);try{await w(t),l(s=>s.filter(a=>a.name!==t))}catch{alert("Erro ao excluir arquivo.")}finally{d(null)}}},f=(t,s)=>{navigator.clipboard.writeText(t),m(s),setTimeout(()=>m(null),2e3)},N=t=>t.includes("image")?e.jsx(F,{size:20,className:"text-purple-400"}):t.includes("pdf")?e.jsx(h,{size:20,className:"text-red-400"}):e.jsx(h,{size:20,className:"text-fire-gray"}),b=t=>{if(t===0)return"0 B";const s=1024,a=["B","KB","MB","GB"],r=Math.floor(Math.log(t)/Math.log(s));return parseFloat((t/Math.pow(s,r)).toFixed(2))+" "+a[r]};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white font-montserrat",children:"Biblioteca de Arquivos"}),e.jsx("p",{className:"text-fire-gray mt-1",children:"Gerencie os uploads feitos no Supabase Storage (bucket: challenges_assets)."})]}),e.jsx("div",{className:"bg-fire-secondary/20 border border-white/5 rounded-xl overflow-hidden",children:u?e.jsxs("div",{className:"p-12 flex justify-center text-fire-gray",children:[e.jsx(x,{className:"animate-spin mr-2"})," Carregando arquivos..."]}):n.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-black/20 text-fire-gray text-xs uppercase tracking-wider border-b border-white/5",children:[e.jsx("th",{className:"p-4 font-medium",children:"Arquivo"}),e.jsx("th",{className:"p-4 font-medium",children:"Tamanho"}),e.jsx("th",{className:"p-4 font-medium",children:"Tipo"}),e.jsx("th",{className:"p-4 font-medium",children:"Data Upload"}),e.jsx("th",{className:"p-4 font-medium text-right",children:"Ações"})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:n.map(t=>{var s,a,r;return e.jsxs("tr",{className:"hover:bg-white/5 transition-colors group",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/5 rounded border border-white/10",children:N(((s=t.metadata)==null?void 0:s.mimetype)||"")}),e.jsx("span",{className:"text-sm font-medium text-white break-all max-w-xs",children:t.name})]})}),e.jsx("td",{className:"p-4 text-sm text-fire-gray font-mono",children:b(((a=t.metadata)==null?void 0:a.size)||0)}),e.jsx("td",{className:"p-4 text-sm text-fire-gray",children:((r=t.metadata)==null?void 0:r.mimetype)||"Desconhecido"}),e.jsx("td",{className:"p-4 text-sm text-fire-gray",children:new Date(t.created_at).toLocaleDateString("pt-BR")}),e.jsx("td",{className:"p-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>t.url&&f(t.url,t.id),className:"p-2 rounded-lg text-fire-gray hover:text-white hover:bg-white/10 transition-colors relative",title:"Copiar Link",children:p===t.id?e.jsx(y,{size:18,className:"text-green-400"}):e.jsx(z,{size:18})}),e.jsx("button",{onClick:()=>g(t.name),disabled:c===t.name,className:"p-2 rounded-lg text-fire-gray hover:text-red-400 hover:bg-red-500/10 transition-colors",title:"Excluir",children:c===t.name?e.jsx(x,{size:18,className:"animate-spin"}):e.jsx(k,{size:18})})]})})]},t.id)})})]})}):e.jsxs("div",{className:"p-12 text-center flex flex-col items-center",children:[e.jsx(C,{size:48,className:"text-fire-gray/30 mb-4"}),e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Biblioteca Vazia"}),e.jsx("p",{className:"text-fire-gray text-sm",children:"Nenhum arquivo encontrado na raiz do bucket. Os arquivos podem estar dentro de pastas de dias (ex: day-01/)."})]})})]})};export{T as AdminLibrary};
