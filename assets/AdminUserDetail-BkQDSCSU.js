import{z as w,j as e,B as f,U as p,q as g,v as y,r as _}from"./index-CJHEqyXL.js";import{h as C,u as A,r as a}from"./vendor-gtDS_TVX.js";import{a as D,s as k,g as S,G as z,af as B,m as u,d as R,a2 as T,R as U}from"./ui-R5Y-RMdR.js";import"./supabase-CBvtPKqy.js";const V=()=>{var h;const{id:n}=C(),b=A(),[s,c]=a.useState(null),[j,o]=a.useState(!0),[r,i]=a.useState(!1),[l,x]=a.useState("progress");a.useEffect(()=>{n&&N(n)},[n]);const N=async t=>{o(!0);const d=await w(t);d&&c(d),o(!1)},m=async t=>{!s||r||(i(!0),await y(s.id,t),c({...s,status:t}),i(!1))},v=async t=>{!s||r||window.confirm("Alterar nível de acesso?")&&(i(!0),await _(s.id,t),c({...s,role:t}),i(!1))};return j?e.jsxs("div",{className:"p-8 text-center text-fire-gray",children:[e.jsx(D,{className:"animate-spin inline mr-2"})," Carregando dados do usuário..."]}):s?e.jsxs("div",{className:"space-y-8 animate-in fade-in pb-12",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>b("/admin/users"),className:"p-2 rounded-lg bg-white/5 hover:bg-white/10 text-white transition-colors",children:e.jsx(k,{size:20})}),e.jsx("h1",{className:"text-2xl font-bold text-white font-montserrat",children:"Detalhes do Usuário"})]}),e.jsx("div",{className:"bg-fire-secondary/20 border border-white/5 rounded-2xl p-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-8",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-fire-orange to-fire-dark border-4 border-fire-secondary flex items-center justify-center text-3xl font-bold text-white shadow-lg",children:s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:"",className:"w-full h-full rounded-full object-cover"}):((h=s.full_name)==null?void 0:h.charAt(0))||s.email.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:s.full_name||"Sem Nome"}),e.jsx("span",{className:`text-xs font-bold px-2 py-1 rounded uppercase ${s.status==="ACTIVE"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:s.status==="ACTIVE"?"Ativo":s.status}),s.role==="admin"&&e.jsx("span",{className:"text-xs font-bold px-2 py-1 rounded uppercase bg-purple-500/20 text-purple-400",children:"Admin"})]}),e.jsxs("div",{className:"text-fire-gray flex items-center gap-2",children:[e.jsx(S,{size:16})," ",s.email]}),e.jsxs("div",{className:"text-fire-gray flex items-center gap-2 text-sm",children:[e.jsx(z,{size:16})," Cadastrado em ",new Date(s.created_at).toLocaleDateString("pt-BR")]})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-[160px]",children:[s.status==="ACTIVE"?e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>m(p.BLOCKED),disabled:r,children:[e.jsx(B,{size:16,className:"mr-2"})," Bloquear"]}):e.jsxs(f,{variant:"primary",size:"sm",onClick:()=>m(p.ACTIVE),disabled:r,children:[e.jsx(u,{size:16,className:"mr-2"})," Ativar"]}),e.jsx("button",{onClick:()=>v(s.role==="admin"?g.MEMBER:g.ADMIN),className:"text-xs text-fire-gray hover:text-white underline text-center",children:s.role==="admin"?"Remover Admin":"Tornar Admin"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-fire-secondary/20 border border-white/5 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 text-fire-orange mb-2",children:[e.jsx(R,{size:24})," ",e.jsx("span",{className:"font-bold",children:"Progresso Geral"})]}),e.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:[s.progress.completion_percentage,"%"]}),e.jsx("div",{className:"w-full bg-black/30 h-2 rounded-full overflow-hidden",children:e.jsx("div",{className:"bg-fire-orange h-full",style:{width:`${s.progress.completion_percentage}%`}})})]}),e.jsxs("div",{className:"bg-fire-secondary/20 border border-white/5 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 text-blue-400 mb-2",children:[e.jsx(u,{size:24})," ",e.jsx("span",{className:"font-bold",children:"Tarefas"})]}),e.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:[s.progress.completed_tasks," ",e.jsxs("span",{className:"text-lg text-fire-gray font-normal",children:["/ ",s.progress.total_tasks]})]}),e.jsx("div",{className:"text-xs text-fire-gray",children:"Tarefas concluídas"})]}),e.jsxs("div",{className:"bg-fire-secondary/20 border border-white/5 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 text-purple-400 mb-2",children:[e.jsx(T,{size:24})," ",e.jsx("span",{className:"font-bold",children:"Última Atividade"})]}),e.jsx("div",{className:"text-lg font-bold text-white mb-1",children:s.progress.last_activity?new Date(s.progress.last_activity).toLocaleDateString("pt-BR"):"Nunca"}),e.jsx("div",{className:"text-xs text-fire-gray",children:s.progress.last_activity?new Date(s.progress.last_activity).toLocaleTimeString("pt-BR"):"-"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex gap-4 border-b border-white/10 mb-6",children:[e.jsx("button",{onClick:()=>x("progress"),className:`pb-3 px-2 font-medium transition-colors border-b-2 ${l==="progress"?"border-fire-orange text-white":"border-transparent text-fire-gray hover:text-white"}`,children:"Histórico de Tarefas"}),e.jsx("button",{onClick:()=>x("notes"),className:`pb-3 px-2 font-medium transition-colors border-b-2 ${l==="notes"?"border-fire-orange text-white":"border-transparent text-fire-gray hover:text-white"}`,children:"Anotações & Reflexões"})]}),l==="progress"&&e.jsx("div",{className:"bg-fire-secondary/10 rounded-xl border border-white/5 overflow-hidden",children:s.completed_tasks_list.length>0?e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-black/20 text-xs uppercase text-fire-gray",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Dia"}),e.jsx("th",{className:"p-4",children:"Tarefa"}),e.jsx("th",{className:"p-4 text-right",children:"Data Conclusão"})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:s.completed_tasks_list.map((t,d)=>e.jsxs("tr",{className:"hover:bg-white/5",children:[e.jsxs("td",{className:"p-4 font-bold text-fire-orange",children:["Dia ",t.day_number]}),e.jsx("td",{className:"p-4 text-white",children:t.task_title}),e.jsx("td",{className:"p-4 text-right text-fire-gray text-sm",children:new Date(t.completed_at).toLocaleString("pt-BR")})]},d))})]}):e.jsx("div",{className:"p-8 text-center text-fire-gray",children:"Nenhuma tarefa completada ainda."})}),l==="notes"&&e.jsx("div",{className:"space-y-4",children:s.notes.length>0?s.notes.map(t=>e.jsxs("div",{className:"bg-fire-secondary/20 p-6 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsxs("h3",{className:"font-bold text-white flex items-center gap-2",children:[e.jsx(U,{size:18,className:"text-blue-400"}),t.day_title]}),e.jsx("span",{className:"text-xs text-fire-gray",children:new Date(t.updated_at).toLocaleDateString("pt-BR")})]}),e.jsxs("div",{className:"bg-black/20 p-4 rounded-lg text-fire-light italic",children:['"',t.content,'"']})]},t.id)):e.jsx("div",{className:"p-8 text-center text-fire-gray border border-dashed border-white/10 rounded-xl",children:"Nenhuma anotação registrada."})})]})]}):e.jsx("div",{className:"p-8 text-center text-white",children:"Usuário não encontrado."})};export{V as AdminUserDetail};
