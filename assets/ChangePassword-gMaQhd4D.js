import{j as e,B as j,s as i}from"./index-CJHEqyXL.js";import{r as a,u as w}from"./vendor-gtDS_TVX.js";import{S as N,m as v,L as f,a as y}from"./ui-R5Y-RMdR.js";import"./supabase-CBvtPKqy.js";const k=()=>{const[s,x]=a.useState(""),[n,h]=a.useState(""),[l,d]=a.useState(!1),[c,t]=a.useState(null),[p,b]=a.useState(!1);w();const g=async r=>{if(r.preventDefault(),t(null),s!==n){t("As senhas não coincidem.");return}if(s.length<6){t("A senha deve ter pelo menos 6 caracteres.");return}d(!0);try{const{error:o}=await i.auth.updateUser({password:s});if(o)throw o;const u=await i.auth.getUser();if(u.data.user){const{error:m}=await i.from("profiles").update({must_change_password:!1}).eq("id",u.data.user.id);if(m)throw m}b(!0),setTimeout(()=>{window.location.href="/"},2e3)}catch(o){t(o.message||"Erro ao atualizar senha.")}finally{d(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-fire-dark p-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute -top-20 -right-20 w-96 h-96 bg-fire-orange/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute -bottom-20 -left-20 w-80 h-80 bg-blue-900/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"w-full max-w-md bg-fire-secondary/30 backdrop-blur-lg border border-white/5 p-8 rounded-2xl shadow-2xl animate-in fade-in zoom-in duration-500",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-16 h-16 bg-fire-orange/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"text-fire-orange",size:32})})}),e.jsx("h2",{className:"text-2xl font-bold text-center mb-2 text-white font-montserrat",children:"Defina sua Senha"}),e.jsx("p",{className:"text-center text-fire-gray mb-8 text-sm",children:"Por segurança, você precisa definir uma nova senha para continuar acessando a plataforma."}),c&&e.jsx("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/50 rounded-lg text-red-200 text-sm text-center",children:c}),p?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(v,{className:"mx-auto text-green-400 mb-4",size:48}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Senha Atualizada!"}),e.jsx("p",{className:"text-fire-gray",children:"Redirecionando para o painel..."})]}):e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-fire-gray",children:"Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(f,{className:"absolute left-3 top-3.5 text-fire-gray",size:18}),e.jsx("input",{type:"password",required:!0,value:s,onChange:r=>x(r.target.value),className:"w-full bg-fire-dark border border-fire-secondary rounded-lg py-3 pl-10 pr-4 text-white placeholder-fire-secondary/50 focus:outline-none focus:ring-2 focus:ring-fire-orange focus:border-transparent transition-all",placeholder:"Mínimo 6 caracteres"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-fire-gray",children:"Confirmar Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(f,{className:"absolute left-3 top-3.5 text-fire-gray",size:18}),e.jsx("input",{type:"password",required:!0,value:n,onChange:r=>h(r.target.value),className:"w-full bg-fire-dark border border-fire-secondary rounded-lg py-3 pl-10 pr-4 text-white placeholder-fire-secondary/50 focus:outline-none focus:ring-2 focus:ring-fire-orange focus:border-transparent transition-all",placeholder:"Repita a nova senha"})]})]}),e.jsx(j,{type:"submit",fullWidth:!0,disabled:l,children:l?e.jsx(y,{className:"animate-spin"}):"Atualizar e Entrar"})]})]})]})};export{k as ChangePassword};
