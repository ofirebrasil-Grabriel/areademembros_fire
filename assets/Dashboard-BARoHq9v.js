import{j as e,s as N,g as E,a as F,b as B}from"./index-D1VfHaEt.js";import{r as c,u as R}from"./vendor-gtDS_TVX.js";import{d as h,h as L,i as $,j as w,k as y,l as k,m as C,L as M,n as A,o as O,Z as U,p as V,q as J,r as W}from"./ui-R5Y-RMdR.js";import"./supabase-B6PhnEZn.js";const ee=()=>{const[i,z]=c.useState([]),[n,D]=c.useState([]),[Z,S]=c.useState([]),[T,u]=c.useState(!0),[_,b]=c.useState(!1),p=R();c.useEffect(()=>{let t=!0;return(async()=>{try{u(!0);const a=new Promise((G,P)=>setTimeout(()=>P(new Error("Request timed out")),1e4)),{data:{user:l}}=await N.auth.getUser(),d=(l==null?void 0:l.id)||"mock-user-id";localStorage.getItem("fire_last_login")||(b(!0),localStorage.setItem("fire_last_login",new Date().toISOString()));const[m,f,g]=await Promise.race([Promise.all([E(),F(d),B()]),a]);t&&(D(f||[]),z(m||[]),S(g||[]),u(!1))}catch(a){console.error("Dashboard loading error:",a),t&&u(!1)}})(),()=>{t=!1}},[]);const q=t=>{if(t===0)return"open";const s=i[t-1];if(!s)return"locked";const a=s.tasks.map(o=>o.id);return a.filter(o=>n.includes(o)).length===a.length&&a.length>0?"open":"locked"},j=()=>i.length===0?0:i.filter(s=>s.tasks.length>0&&s.tasks.every(a=>n.includes(a.id))).length/i.length*100;if(T)return e.jsxs("div",{className:"flex flex-col h-64 items-center justify-center text-white gap-4",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-fire-orange border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-fire-gray animate-pulse",children:"Carregando sua jornada..."})]});if(i.length===0)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-[60vh] text-center px-4",children:[e.jsx("div",{className:"bg-fire-secondary/50 p-6 rounded-full mb-6",children:e.jsx(h,{size:48,className:"text-fire-orange opacity-50"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Não foi possível carregar os dados"}),e.jsx("p",{className:"text-fire-gray mb-8 max-w-md",children:"Ocorreu um erro ao conectar com o servidor ou sua sessão expirou."}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-2 bg-fire-secondary hover:bg-fire-secondary/80 text-white rounded-lg font-medium transition-colors",children:"Tentar Novamente"}),e.jsx("button",{onClick:async()=>{try{await N.auth.signOut()}catch(t){console.error("Logout error:",t)}finally{localStorage.clear(),window.location.reload()}},className:"px-6 py-2 bg-fire-orange hover:bg-fire-orange/80 text-white rounded-lg font-medium transition-colors",children:"Sair da Conta"})]})]});let v=0;for(const t of i){const s=t.tasks.map(l=>l.id);if(s.length===0||s.every(l=>n.includes(l)))v=t.day_number;else break}const I=v+1,r=i.find(t=>t.day_number===I)||i[i.length-1],x=(()=>{const t=n.length;let s=0;return i.forEach(l=>{const d=l.tasks.map(o=>o.id);d.length>0&&d.every(o=>n.includes(o))&&s++}),[{id:"start",title:"Primeiro Passo",description:"Completou o Dia 1 do desafio.",icon:e.jsx(A,{size:24}),unlocked:s>=1,requirement:"Completar Dia 1"},{id:"focus",title:"Foco Total",description:"Completou 5 tarefas.",icon:e.jsx(k,{size:24}),unlocked:t>=5,requirement:"5 Tarefas"},{id:"executor",title:"Executor",description:"Completou 10 tarefas.",icon:e.jsx(O,{size:24}),unlocked:t>=10,requirement:"10 Tarefas"},{id:"momentum",title:"Pegando Ritmo",description:"Completou 3 dias consecutivos.",icon:e.jsx(U,{size:24}),unlocked:s>=3,requirement:"Completar 3 Dias"},{id:"halfway",title:"Meio Caminho",description:"Chegou na metade! 7 dias completados.",icon:e.jsx(V,{size:24}),unlocked:s>=7,requirement:"Completar 7 Dias"},{id:"imparavel",title:"Imparável",description:"Completou 25 tarefas.",icon:e.jsx(y,{size:24}),unlocked:t>=25,requirement:"25 Tarefas"},{id:"reta_final",title:"Reta Final",description:"Completou 12 dias do desafio.",icon:e.jsx(J,{size:24}),unlocked:s>=12,requirement:"Completar 12 Dias"},{id:"lenda_desafio",title:"Lenda do Desafio",description:"Completou 40 tarefas.",icon:e.jsx(W,{size:24}),unlocked:t>=40,requirement:"40 Tarefas"},{id:"fire_master",title:"Mestre FIRE",description:"Completou todo o desafio de 15 dias.",icon:e.jsx(h,{size:24}),unlocked:s>=15,requirement:"Completar 15 Dias"}].find(l=>!l.unlocked)||null})();return e.jsxs("div",{className:"space-y-12 pb-12",children:[_&&e.jsxs("div",{className:"bg-fire-orange/10 border border-fire-orange/30 p-6 rounded-2xl flex items-start gap-4 animate-in slide-in-from-top-4",children:[e.jsx("div",{className:"bg-fire-orange p-3 rounded-full text-white shrink-0",children:e.jsx(h,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Bem-vindo ao Desafio FIRE 15 Dias!"}),e.jsx("p",{className:"text-fire-light text-sm mb-4",children:"Estamos felizes em ter você aqui. Sua jornada para a liberdade financeira começa agora."}),e.jsx("button",{onClick:()=>b(!1),className:"text-xs font-bold text-fire-orange hover:text-white uppercase tracking-wider",children:"Fechar Mensagem"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-gradient-to-br from-fire-dark to-fire-secondary rounded-2xl p-8 relative overflow-hidden border border-white/5",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-fire-orange/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/3"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("span",{className:"inline-block px-3 py-1 rounded-full bg-fire-orange/20 text-fire-orange text-xs font-bold mb-4 border border-fire-orange/20",children:"DESAFIO FIRE 15 DIAS"}),e.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-white mb-4 font-montserrat leading-tight",children:["Sua Liberdade ",e.jsx("br",{}),"Financeira Começa Aqui"]}),e.jsxs("p",{className:"text-fire-gray mb-8 max-w-md text-lg",children:['"A disciplina é a ponte entre metas e realizações." Você está no dia ',(r==null?void 0:r.day_number)||1,"."]}),e.jsxs("button",{onClick:()=>r&&p(`/day/${r.day_number}`),className:"bg-fire-orange hover:bg-orange-600 text-white px-8 py-3 rounded-lg font-bold transition-all shadow-lg shadow-fire-orange/30 flex items-center gap-2 group",children:[e.jsx(L,{className:"fill-white text-fire-orange"}),"Continuar Jornada",e.jsx($,{size:18,className:"group-hover:translate-x-1 transition-transform"})]})]}),e.jsx("div",{className:"absolute right-0 top-0 w-96 h-96 bg-fire-orange/5 rounded-full blur-3xl -translate-y-1/2 translate-x-1/3"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-fire-secondary/20 to-fire-dark border border-white/5 rounded-2xl p-6 flex flex-col relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-fire-orange/10 rounded-full blur-2xl -translate-y-1/2 translate-x-1/3 group-hover:bg-fire-orange/20 transition-colors"}),e.jsxs("h2",{className:"text-lg font-bold text-white mb-4 font-montserrat flex items-center gap-2 relative z-10",children:[e.jsx(w,{size:18,className:"text-yellow-500"})," Próxima Conquista"]}),x?e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center relative z-10",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-white/5 flex items-center justify-center mb-3 border border-white/10 group-hover:scale-110 transition-transform duration-300",children:e.jsx("div",{className:"text-fire-gray/50 group-hover:text-fire-orange transition-colors",children:x.icon})}),e.jsx("h3",{className:"text-white font-bold text-lg mb-1",children:x.title}),e.jsx("p",{className:"text-fire-gray text-xs mb-3",children:x.description}),e.jsxs("p",{className:"text-[10px] text-fire-gray mt-2 uppercase tracking-wider bg-white/5 px-3 py-1 rounded-full",children:["Requer: ",e.jsx("span",{className:"text-white font-bold",children:x.requirement})]})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center relative z-10",children:[e.jsx(h,{size:48,className:"text-fire-orange mb-2 animate-pulse"}),e.jsx("h3",{className:"text-white font-bold",children:"Você é um Mestre!"}),e.jsx("p",{className:"text-fire-gray text-sm",children:"Todas as conquistas desbloqueadas."})]}),e.jsx("button",{onClick:()=>p("/achievements"),className:"mt-4 w-full py-2 bg-white/5 hover:bg-white/10 text-fire-gray hover:text-white rounded-lg text-xs font-bold uppercase transition-colors relative z-10",children:"Ver Todas"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-900/80 to-gray-900/40 border border-white/10 rounded-2xl p-6 grid grid-cols-2 lg:grid-cols-4 gap-8 shadow-xl backdrop-blur-sm relative overflow-hidden group",children:[e.jsx("div",{className:"absolute inset-0 bg-fire-orange/5 opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-blue-500/10 text-blue-400",children:e.jsx(y,{size:16})}),e.jsx("p",{className:"text-fire-gray text-xs uppercase tracking-widest font-semibold",children:"Progresso"})]}),e.jsxs("div",{className:"flex items-end gap-3",children:[e.jsxs("span",{className:"text-3xl font-bold text-white tracking-tight",children:[Math.round(j()),"%"]}),e.jsx("div",{className:"flex-1 pb-2.5",children:e.jsx("div",{className:"w-full bg-white/5 h-2 rounded-full overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-400 h-full rounded-full shadow-[0_0_10px_rgba(59,130,246,0.5)]",style:{width:`${j()}%`}})})})]})]}),e.jsxs("div",{className:"relative border-l border-white/5 pl-0 md:pl-8 lg:border-l-0 xl:border-l",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-fire-orange/10 text-fire-orange",children:e.jsx(k,{size:16})}),e.jsx("p",{className:"text-fire-gray text-xs uppercase tracking-widest font-semibold",children:"Foco de Hoje"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-xs font-bold text-fire-orange uppercase mb-0.5 tracking-wide",children:["Dia ",(r==null?void 0:r.day_number)||1]}),e.jsx("span",{className:"text-sm font-bold text-white leading-tight line-clamp-1",title:r==null?void 0:r.title,children:r!=null&&r.title?r.title.split(": ")[1]||r.title:"Carregando..."})]})]}),e.jsxs("div",{className:"relative border-l border-white/5 pl-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-green-500/10 text-green-400",children:e.jsx(C,{size:16})}),e.jsx("p",{className:"text-fire-gray text-xs uppercase tracking-widest font-semibold",children:"Tarefas"})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-2xl font-bold text-white block leading-none",children:n.length}),e.jsx("span",{className:"text-[10px] text-green-400 font-bold uppercase tracking-wider",children:"Feitas"})]}),e.jsx("div",{className:"h-8 w-px bg-white/10"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-2xl font-bold text-white/50 block leading-none",children:i.reduce((t,s)=>t+s.tasks.length,0)-n.length}),e.jsx("span",{className:"text-[10px] text-fire-gray/50 font-bold uppercase tracking-wider",children:"Faltam"})]})]})]}),e.jsxs("div",{className:"relative border-l border-white/5 pl-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-purple-500/10 text-purple-400",children:e.jsx(w,{size:16})}),e.jsx("p",{className:"text-fire-gray text-xs uppercase tracking-widest font-semibold",children:"Conclusão"})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-400",children:i.filter(t=>t.tasks.length>0&&t.tasks.every(s=>n.includes(s.id))).length}),e.jsxs("span",{className:"text-fire-gray text-sm font-medium",children:["/ ",i.length," dias"]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-white font-montserrat mb-6 flex items-center gap-2",children:[e.jsx(h,{className:"text-fire-orange"})," Sua Jornada"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:i.map((t,s)=>{const a=q(s),d=t.tasks.map(g=>g.id).filter(g=>n.includes(g)).length,o=t.tasks.length>0?d/t.tasks.length*100:0,m=o===100,f=(r==null?void 0:r.day_number)===t.day_number;return e.jsxs("div",{onClick:()=>a==="open"&&p(`/day/${t.day_number}`),className:`
                  relative group rounded-2xl border transition-all duration-300 flex flex-col justify-between h-[280px] overflow-hidden
                  ${a==="locked"?"bg-[#0B1219] border-white/5 opacity-70 cursor-not-allowed":f?"bg-fire-secondary/40 border-fire-orange/50 shadow-lg shadow-fire-orange/10 cursor-pointer hover:translate-y-[-4px]":"bg-fire-secondary/20 border-white/5 hover:bg-fire-secondary/30 hover:border-white/10 cursor-pointer hover:translate-y-[-4px]"}
                `,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent to-black/80 pointer-events-none"}),e.jsxs("div",{className:"relative p-6 z-10 flex flex-col h-full justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("span",{className:`
                        text-[10px] font-black px-3 py-1 rounded-full border tracking-widest uppercase
                        ${m?"bg-green-500/10 text-green-400 border-green-500/20":f?"bg-fire-orange text-white border-fire-orange shadow-lg shadow-fire-orange/20":"bg-white/5 text-fire-gray border-white/10"}
                      `,children:["DIA ",t.day_number.toString().padStart(2,"0")]}),a==="locked"?e.jsx(M,{className:"text-fire-gray/30",size:20}):m?e.jsx(C,{className:"text-green-400",size:20}):null]}),e.jsx("h3",{className:`text-xl font-bold mb-2 font-montserrat leading-tight ${a==="locked"?"text-fire-gray":"text-white"}`,children:t.title.includes(":")?t.title.split(": ")[1]:t.title}),e.jsx("p",{className:"text-xs text-fire-gray/80 line-clamp-3 leading-relaxed",children:t.description})]}),e.jsx("div",{className:"mt-4",children:a==="open"?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-[10px] font-bold text-fire-gray uppercase tracking-wider mb-2",children:[e.jsxs("span",{children:[Math.round(o),"%"]}),e.jsxs("span",{children:[d,"/",t.tasks.length]})]}),e.jsx("div",{className:"w-full bg-black/30 h-1.5 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${m?"bg-green-500":"bg-fire-orange"}`,style:{width:`${o}%`}})})]}):e.jsx("div",{className:"flex items-center justify-center pt-4 border-t border-white/5 text-fire-gray/40 text-xs uppercase tracking-widest font-bold",children:"Bloqueado"})})]})]},t.id)})})]})]})};export{ee as Dashboard};
