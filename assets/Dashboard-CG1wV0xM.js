import{j as e,l as S,m as L,n as R,o as k}from"./index-BWNE2clS.js";import{r as i,u as M}from"./vendor-gtDS_TVX.js";import{a as U,U as P,k as z,a2 as p,a3 as f,a4 as b,w as T}from"./ui-R5Y-RMdR.js";import"./supabase-B6PhnEZn.js";const H=()=>{const[r,u]=i.useState(null),[d,j]=i.useState([]),[c,v]=i.useState([]),[N,y]=i.useState(!0),w=M(),[o,D]=i.useState([]);if(i.useEffect(()=>{(async()=>{const[s,a,l,n]=await Promise.all([S(),L(),R(),k()]);u(s),j(a),D(l),v(n),y(!1)})()},[]),N||!r)return e.jsxs("div",{className:"flex items-center justify-center h-64 text-fire-gray",children:[e.jsx(U,{className:"animate-spin mr-2"})," Carregando estatísticas..."]});const C=[{label:"Membros Totais",value:r.totalMembers,icon:P,change:"Total",color:"text-blue-400",bg:"bg-blue-400/10"},{label:"Novos Membros (30d)",value:r.newMembersLast30Days||0,icon:z,change:"Crescimento",color:"text-green-400",bg:"bg-green-400/10"},{label:"Usuários Ativos",value:r.activeUsers,icon:p,change:`${Math.round((r.activeUsers/r.totalMembers||0)*100)}%`,color:"text-fire-orange",bg:"bg-fire-orange/10"},{label:"Conclusão Média",value:`${r.avgCompletion}%`,icon:f,change:"Geral",color:"text-purple-400",bg:"bg-purple-400/10"}],E=Math.max(...o.map(t=>t.count),5);return e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500 pb-12",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white font-montserrat",children:"Painel Administrativo"}),e.jsx("p",{className:"text-fire-gray mt-1",children:"Visão geral do desempenho e saúde do Desafio FIRE."})]}),e.jsxs("div",{className:"text-sm text-fire-gray bg-white/5 px-4 py-2 rounded-lg border border-white/5 flex items-center gap-2",children:[e.jsx(b,{size:14}),"Atualizado: ",new Date().toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:C.map((t,s)=>e.jsxs("div",{className:"bg-fire-secondary/20 border border-white/5 p-6 rounded-xl hover:bg-fire-secondary/30 transition-all hover:-translate-y-1",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${t.bg} ${t.color}`,children:e.jsx(t.icon,{size:24})}),e.jsx("span",{className:"text-xs font-medium px-2 py-1 rounded-full bg-white/5 text-fire-gray",children:t.change})]}),e.jsx("h3",{className:"text-2xl font-bold text-white mb-1 font-montserrat",children:t.value}),e.jsx("p",{className:"text-fire-gray text-sm",children:t.label})]},s))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-fire-secondary/20 border border-white/5 rounded-xl p-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("h2",{className:"text-xl font-bold text-white font-montserrat flex items-center gap-2",children:[e.jsx(f,{className:"text-fire-orange",size:20}),"Tarefas Concluídas (Últimos 14 dias)"]})}),e.jsxs("div",{className:"h-64 flex items-end justify-between gap-3 px-2",children:[o.map((t,s)=>e.jsxs("div",{className:"w-full relative group flex flex-col items-center gap-2",children:[e.jsxs("div",{className:"absolute -top-8 bg-white text-fire-dark text-xs font-bold px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity z-10 whitespace-nowrap",children:[t.count," tarefas"]}),e.jsx("div",{className:"w-full bg-gradient-to-t from-fire-secondary to-fire-orange/50 rounded-t-sm hover:from-fire-orange hover:to-fire-orange transition-all duration-300 cursor-pointer",style:{height:`${t.count/E*100}%`,minHeight:"4px"}}),e.jsx("span",{className:"text-[10px] text-fire-gray rotate-45 origin-left mt-2",children:t.date.slice(0,5)})]},s)),o.length===0&&e.jsx("div",{className:"w-full h-full flex items-center justify-center text-fire-gray text-sm",children:"Sem dados de engajamento recentes."})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-fire-secondary/20 border border-white/5 rounded-xl p-6",children:[e.jsxs("h2",{className:"text-lg font-bold text-white mb-4 font-montserrat flex items-center gap-2",children:[e.jsx(T,{size:18,className:"text-fire-orange"}),"Conteúdo"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg border border-white/5",children:[e.jsx("div",{className:"text-sm text-fire-gray",children:"Módulo de Aulas"}),e.jsx("div",{className:"font-bold text-white",children:"15 Dias"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg border border-white/5",children:[e.jsx("div",{className:"text-sm text-fire-gray",children:"Status"}),e.jsx("div",{className:"font-bold text-green-400 text-xs uppercase bg-green-500/10 px-2 py-1 rounded",children:"Ativo"})]}),e.jsx("button",{onClick:()=>w("/admin/challenges"),className:"w-full mt-2 text-xs text-fire-orange hover:text-white transition-colors text-center",children:"Gerenciar Conteúdo →"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-fire-secondary/20 border border-white/5 rounded-xl p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white font-montserrat mb-4",children:"Atividade Recente"}),d.length>0?e.jsx("div",{className:"space-y-4",children:d.map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between border-b border-white/5 pb-3 last:border-0 last:pb-0 hover:bg-white/5 p-2 rounded transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-fire-orange/20 flex items-center justify-center text-fire-orange text-xs font-bold border border-fire-orange/20",children:t.user_name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-white",children:[e.jsx("span",{className:"font-bold",children:t.user_name})," completou tarefa:"]}),e.jsxs("p",{className:"text-xs text-fire-gray",children:["Dia ",t.day_number," - ",t.task_title]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xs text-fire-gray flex items-center gap-1 justify-end",children:[e.jsx(b,{size:12}),new Date(t.completed_at).toLocaleDateString("pt-BR")]}),e.jsx("div",{className:"text-[10px] text-fire-gray/60",children:new Date(t.completed_at).toLocaleTimeString("pt-BR")})]})]},t.id||s))}):e.jsx("div",{className:"text-center py-8 text-fire-gray",children:e.jsx("p",{children:"Nenhuma atividade recente registrada."})})]}),e.jsxs("div",{className:"bg-fire-secondary/20 border border-white/5 rounded-xl p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white font-montserrat mb-4 flex items-center gap-2",children:[e.jsx(p,{size:20,className:"text-blue-400"}),"Logs de Integração (Hotmart)"]}),e.jsx("div",{className:"space-y-2 overflow-y-auto max-h-[400px] pr-2",children:c.length>0?c.map((t,s)=>{var x,m,g,h;const a=typeof t.payload=="string"?JSON.parse(t.payload):t.payload,l=a.event||a.status||"UNKNOWN",n=a.email||((m=(x=a.data)==null?void 0:x.buyer)==null?void 0:m.email)||"No Email",A=a.prod||((h=(g=a.data)==null?void 0:g.product)==null?void 0:h.id)||"N/A";return e.jsxs("div",{className:"bg-white/5 p-3 rounded-lg border border-white/5 text-xs",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:`font-bold px-2 py-0.5 rounded ${["PURCHASE_APPROVED","APPROVED","COMPLETED"].includes(l)?"bg-green-500/20 text-green-400":["CANCELED","REFUNDED","CHARGEBACK"].includes(l)?"bg-red-500/20 text-red-400":"bg-blue-500/20 text-blue-400"}`,children:l}),e.jsx("span",{className:"text-fire-gray",children:new Date(t.created_at).toLocaleString("pt-BR")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-fire-gray block text-[10px] uppercase",children:"Email"}),e.jsx("span",{className:"text-white truncate block",title:n,children:n})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-fire-gray block text-[10px] uppercase",children:"Produto ID"}),e.jsx("span",{className:"text-white font-mono",children:A})]})]})]},s)}):e.jsx("div",{className:"text-center py-8 text-fire-gray",children:e.jsx("p",{children:"Nenhum log de webhook encontrado."})})})]})]})]})};export{H as AdminDashboard};
